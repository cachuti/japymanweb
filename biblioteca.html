<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Box Zone Film</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #0f172a;
      --bg-medium: #1e293b;
      --text-light: #e2e8f0;
      --focus: #0ea5e9;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: Roboto, sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
      overflow-x: hidden;
    }
    /* === SLIDER === */
    #decor-slider {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 300px; /* aumentado */
      overflow: hidden;
      z-index: 10;
      pointer-events: none;
      user-select: none;
    }
    #decor-slider img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    #decor-slider img.active {
      opacity: 1;
    }
    /* HEADER solo lupa */
    .header {
      position: relative;
      z-index: 20;
      margin-top: 320px; /* debajo del slider */
      padding: 10px;
      display: flex;
      justify-content: center;
    }
    .search-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    #search-input {
      display: none;
      padding: 8px;
      border-radius: 6px;
      border: 2px solid transparent;
      background: #2e3e56;
      color: var(--text-light);
      font-size: 16px;
    }
    #search-input.active {
      display: block;
    }
    .search-button {
      background: var(--focus);
      border: none;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
    }
    /* SECCIONES */
    .section-title {
      font-size: 20px;
      margin: 20px 10px 10px;
    }
    .carousel {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding: 0 10px 20px;
    }
    .item-card {
      width: 160px;
      flex-shrink: 0;
      outline: none;
      cursor: pointer;
    }
    .item-card img {
      width: 100%;
      border-radius: 8px;
    }
    .item-title {
      display: block;
      text-align: center;
      margin-top: 4px;
      font-size: 14px;
    }
    .item-card:focus {
      border: 2px solid var(--focus);
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <!-- SLIDER -->
  <div id="decor-slider"></div>

  <!-- HEADER -->
  <div class="header">
    <div class="search-container">
      <input type="text" id="search-input" placeholder="Buscar..." tabindex="-1">
      <button id="search-button" class="search-button" tabindex="0">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </div>
  </div>

  <!-- CONTENIDO -->
  <div id="content-container"></div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    // Configuración Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyD6Tj5S2TvV_k8jq0P4ET_Mxo_YgoWtBwo",
      authDomain: "chunito-d25bb.firebaseapp.com",
      databaseURL: "https://chunito-d25bb-default-rtdb.firebaseio.com",
      projectId: "chunito-d25bb",
      storageBucket: "chunito-d25bb.appspot.com",
      messagingSenderId: "748622352005",
      appId: "1:748622352005:web:f9ea6d2da8af92f76123ec"
    };
    firebase.initializeApp(firebaseConfig);
    var ref = firebase.database().ref("box-zone-estrenos");

    const contentContainer = document.getElementById("content-container");
    const searchInput = document.getElementById("search-input");
    const searchButton = document.getElementById("search-button");

    let allItems = [];
    let rows = [];

    // Render contenido
    function renderContent(data) {
      contentContainer.innerHTML = "";
      allItems = [];
      rows = [];

      data.forEach(category => {
        let sectionTitle = document.createElement('h2');
        sectionTitle.className = "section-title";
        sectionTitle.textContent = category.subtitulo || category.title || "Categoría";
        contentContainer.appendChild(sectionTitle);

        let carousel = document.createElement('div');
        carousel.className = "carousel";

        let rowItems = [];
        Object.entries(category).forEach(([k, item]) => {
          if (k !== "subtitulo") {
            let card = document.createElement('div');
            card.className = "item-card";
            card.tabIndex = 0;
            card.innerHTML = `
              <img src="${item.imagen}" alt="${item.titulo}">
              <span class="item-title">${item.titulo}</span>
            `;
            carousel.appendChild(card);
            rowItems.push(card);
          }
        });
        contentContainer.appendChild(carousel);
        rows.push(carousel);
        allItems.push(rowItems);
      });
    }

    // Firebase load
    ref.on("value", snap => {
      let data = [];
      snap.forEach(sec => data.push(sec.val()));
      renderContent(data);
    });

    // Lupa
    searchButton.addEventListener("click", () => {
      searchInput.classList.toggle("active");
      if (searchInput.classList.contains("active")) {
        searchInput.focus();
      } else {
        searchInput.value = "";
        searchButton.focus();
      }
    });

    searchInput.addEventListener("keydown", e => {
      if (e.key === "Escape") {
        searchInput.classList.remove("active");
        searchButton.focus();
      }
    });

    // SLIDER decorativo (ejemplo 3 imgs)
    const slider = document.getElementById("decor-slider");
    const sliderImages = [
      "https://picsum.photos/1600/300?1",
      "https://picsum.photos/1600/300?2",
      "https://picsum.photos/1600/300?3"
    ];
    sliderImages.forEach((src, i) => {
      let img = document.createElement("img");
      img.src = src;
      if (i === 0) img.classList.add("active");
      slider.appendChild(img);
    });
    let current = 0;
    setInterval(() => {
      const imgs = slider.querySelectorAll("img");
      imgs[current].classList.remove("active");
      current = (current + 1) % imgs.length;
      imgs[current].classList.add("active");
    }, 10000);
  </script>
</body>
</html>

